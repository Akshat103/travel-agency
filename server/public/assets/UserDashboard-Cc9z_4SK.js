import{r as d,u as C,j as e,c as p,d as He,a as ze,b as O,U as g,F as y,al as _e,f as T,B as I,am as We,V as H,W as b,an as Ge,ao as Ke,O as Ve}from"./index-C5piji3D.js";import{u as Je,M as se,a as Ye,S as qe}from"./ClientRoutes-n3ZUXysO.js";import{a as L,u as Qe,B as ne,e as Xe,c as Ze,D as ae,F as re,G as Pe,o as es,H as ss,n as M}from"./NotFound-DGO1RfZr.js";import{u as as,m as ts,B as ns,A as rs,M as ls,a as os,g as cs}from"./AbstractModalHeader-DJnnnCD-.js";const le=d.forwardRef(({bsPrefix:s,active:a,disabled:t,eventKey:r,className:l,variant:o,action:c,as:x,...h},j)=>{s=C(s,"list-group-item");const[n,N]=as({key:ts(r,h.href),active:a,...h}),u=L(v=>{if(t){v.preventDefault(),v.stopPropagation();return}n.onClick(v)});t&&h.tabIndex===void 0&&(h.tabIndex=-1,h["aria-disabled"]=!0);const m=x||(c?h.href?"a":"button":"div");return e.jsx(m,{ref:j,...h,...n,onClick:u,className:p(l,s,N.isActive&&"active",t&&"disabled",o&&`${s}-${o}`,c&&`${s}-action`)})});le.displayName="ListGroupItem";const oe=d.forwardRef((s,a)=>{const{className:t,bsPrefix:r,variant:l,horizontal:o,numbered:c,as:x="div",...h}=Qe(s,{activeKey:"onSelect"}),j=C(r,"list-group");let n;return o&&(n=o===!0?"horizontal":`horizontal-${o}`),e.jsx(ns,{ref:a,...h,as:x,className:p(t,j,l&&`${j}-${l}`,n&&`${j}-${n}`,c&&`${j}-numbered`)})});oe.displayName="ListGroup";const f=Object.assign(oe,{Item:le});var F;function te(s){if((!F&&F!==0||s)&&ne){var a=document.createElement("div");a.style.position="absolute",a.style.top="-9999px",a.style.width="50px",a.style.height="50px",a.style.overflow="scroll",document.body.appendChild(a),F=a.offsetWidth-a.clientWidth,document.body.removeChild(a)}return F}const ce=d.forwardRef(({className:s,bsPrefix:a,as:t="div",...r},l)=>(a=C(a,"modal-body"),e.jsx(t,{ref:l,className:p(s,a),...r})));ce.displayName="ModalBody";const z=d.forwardRef(({bsPrefix:s,className:a,contentClassName:t,centered:r,size:l,fullscreen:o,children:c,scrollable:x,...h},j)=>{s=C(s,"modal");const n=`${s}-dialog`,N=typeof o=="string"?`${s}-fullscreen-${o}`:`${s}-fullscreen`;return e.jsx("div",{...h,ref:j,className:p(n,a,l&&`${s}-${l}`,r&&`${n}-centered`,x&&`${n}-scrollable`,o&&N),children:e.jsx("div",{className:p(`${s}-content`,t),children:c})})});z.displayName="ModalDialog";const ie=d.forwardRef(({className:s,bsPrefix:a,as:t="div",...r},l)=>(a=C(a,"modal-footer"),e.jsx(t,{ref:l,className:p(s,a),...r})));ie.displayName="ModalFooter";const de=d.forwardRef(({bsPrefix:s,className:a,closeLabel:t="Close",closeButton:r=!1,...l},o)=>(s=C(s,"modal-header"),e.jsx(rs,{ref:o,...l,className:p(a,s),closeLabel:t,closeButton:r})));de.displayName="ModalHeader";const is=He("h4"),he=d.forwardRef(({className:s,bsPrefix:a,as:t=is,...r},l)=>(a=C(a,"modal-title"),e.jsx(t,{ref:l,className:p(s,a),...r})));he.displayName="ModalTitle";function ds(s){return e.jsx(re,{...s,timeout:null})}function hs(s){return e.jsx(re,{...s,timeout:null})}const ue=d.forwardRef(({bsPrefix:s,className:a,style:t,dialogClassName:r,contentClassName:l,children:o,dialogAs:c=z,"data-bs-theme":x,"aria-labelledby":h,"aria-describedby":j,"aria-label":n,show:N=!1,animation:u=!0,backdrop:m=!0,keyboard:v=!0,onEscapeKeyDown:k,onShow:A,onHide:w,container:me,autoFocus:xe=!0,enforceFocus:je=!0,restoreFocus:ge=!0,restoreFocusOptions:fe,onEntered:Ne,onExit:_,onExiting:ve,onEnter:W,onEntering:G,onExited:K,backdropClassName:V,manager:J,...pe},ye)=>{const[Ce,we]=d.useState({}),[Re,Y]=d.useState(!1),E=d.useRef(!1),$=d.useRef(!1),S=d.useRef(null),[B,Me]=Je(),be=Xe(ye,Me),q=L(w),ke=ze();s=C(s,"modal");const Se=d.useMemo(()=>({onHide:q}),[q]);function Q(){return J||cs({isRTL:ke})}function X(i){if(!ne)return;const R=Q().getScrollbarWidth()>0,ee=i.scrollHeight>es(i).documentElement.clientHeight;we({paddingRight:R&&!ee?te():void 0,paddingLeft:!R&&ee?te():void 0})}const U=L(()=>{B&&X(B.dialog)});Ze(()=>{ae(window,"resize",U),S.current==null||S.current()});const Be=()=>{E.current=!0},De=i=>{E.current&&B&&i.target===B.dialog&&($.current=!0),E.current=!1},Z=()=>{Y(!0),S.current=ss(B.dialog,()=>{Y(!1)})},Ae=i=>{i.target===i.currentTarget&&Z()},Ie=i=>{if(m==="static"){Ae(i);return}if($.current||i.target!==i.currentTarget){$.current=!1;return}w==null||w()},Fe=i=>{v?k==null||k(i):(i.preventDefault(),m==="static"&&Z())},Te=(i,R)=>{i&&X(i),W==null||W(i,R)},Oe=i=>{S.current==null||S.current(),_==null||_(i)},Ee=(i,R)=>{G==null||G(i,R),Pe(window,"resize",U)},$e=i=>{i&&(i.style.display=""),K==null||K(i),ae(window,"resize",U)},Ue=d.useCallback(i=>e.jsx("div",{...i,className:p(`${s}-backdrop`,V,!u&&"show")}),[u,V,s]),P={...t,...Ce};P.display="block";const Le=i=>e.jsx("div",{role:"dialog",...i,style:P,className:p(a,s,Re&&`${s}-static`,!u&&"show"),onClick:m?Ie:void 0,onMouseUp:De,"data-bs-theme":x,"aria-label":n,"aria-labelledby":h,"aria-describedby":j,children:e.jsx(c,{...pe,onMouseDown:Be,className:r,contentClassName:l,children:o})});return e.jsx(ls.Provider,{value:Se,children:e.jsx(os,{show:N,ref:be,backdrop:m,container:me,keyboard:!0,autoFocus:xe,enforceFocus:je,restoreFocus:ge,restoreFocusOptions:fe,onEscapeKeyDown:Fe,onShow:A,onHide:w,onEnter:Te,onEntering:Ee,onEntered:Ne,onExit:Oe,onExiting:ve,onExited:$e,manager:Q(),transition:u?ds:void 0,backdropTransition:u?hs:void 0,renderBackdrop:Ue,renderDialog:Le})})});ue.displayName="Modal";const D=Object.assign(ue,{Body:ce,Header:de,Title:he,Footer:ie,Dialog:z,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),us=()=>{const[s,a]=d.useState(null),[t,r]=d.useState(!1),[l,o]=d.useState(!1),[c,x]=d.useState({}),h=O();d.useEffect(()=>{(async()=>{try{const v=await T.get("/api/user-by-id");a(v.data)}catch(v){I.error(v.response.data.message),v.response.status===401&&h(v.response.data.redirect)}})()},[]);const j=()=>{r(!0),x({name:s.name,email:s.email,mobileNumber:s.mobileNumber,gender:s.gender,dateOfBirth:new Date(s.dateOfBirth).toISOString().substring(0,10),state:s.state})},n=async()=>{try{await T.delete("/api/delete-user"),I.info("User deleted successfully"),localStorage.clear(),h("/")}catch(m){console.error(m)}o(!1)},N=async()=>{try{await T.put("/api/update-user",c),I.success("User updated successfully"),a({...s,...c}),r(!1)}catch(m){console.error(m),I.error("User updated failed")}},u=m=>{x({...c,[m.target.name]:m.target.value})};return e.jsxs("div",{className:"container mt-5 ",children:[s?e.jsx(g,{style:{border:"none"},children:e.jsxs(g.Body,{className:"d-flex flex-column flex-lg-row justify-content-between align-items-center",children:[t?e.jsxs("div",{className:"container align-item-center",children:[e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(g.Text,{children:e.jsx(M.Control,{type:"text",name:"name",value:c.name,onChange:u,placeholder:"Name"})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(g.Text,{children:t?e.jsx(M.Control,{type:"email",name:"email",value:c.email,onChange:u,placeholder:"Email"}):e.jsx(e.Fragment,{})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(g.Text,{children:t?e.jsx(M.Control,{type:"text",name:"mobileNumber",value:c.mobileNumber,onChange:u,placeholder:"Mobile Number"}):e.jsx(e.Fragment,{})})})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(g.Text,{children:t?e.jsxs(M.Control,{as:"select",name:"gender",value:c.gender,onChange:u,children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"}),e.jsx("option",{value:"Other",children:"Other"})]}):e.jsx(e.Fragment,{})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(g.Text,{children:t?e.jsx(M.Control,{type:"date",name:"dateOfBirth",value:c.dateOfBirth,onChange:u}):e.jsx(e.Fragment,{})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(g.Text,{children:t?e.jsx(M.Control,{type:"text",name:"state",value:c.state,onChange:u,placeholder:"State"}):e.jsx(e.Fragment,{})})})]})]}):e.jsx("div",{children:e.jsx("h5",{children:e.jsxs("strong",{children:["Welcome ",s.name]})})}),e.jsxs("div",{className:"p-2",children:[!t&&e.jsx(y,{style:{width:"2.6rem",height:"2.4rem"},variant:"primary",onClick:j,className:"mx-2",children:e.jsx(_e,{})}),e.jsx(y,{variant:"danger",style:{width:"2.6rem",height:"2.4rem"},onClick:()=>o(!0),className:"mx-2",children:e.jsx(se,{})})]})]})}):e.jsx("p",{children:"Loading..."}),e.jsxs(D,{show:l,onHide:()=>o(!1),children:[e.jsx(D.Header,{closeButton:!0,children:e.jsx(D.Title,{children:"Confirm Delete"})}),e.jsx(D.Body,{children:"Are you sure you want to delete this user?"}),e.jsxs(D.Footer,{children:[e.jsx(y,{variant:"secondary",onClick:()=>o(!1),children:e.jsx(Ye,{})}),e.jsx(y,{variant:"danger",onClick:n,children:e.jsx(se,{})})]})]}),t&&e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(y,{variant:"success",onClick:N,children:"Save"})})]})},ms=({order:s})=>{const{serviceDetails:a,amount:t,currency:r,status:l}=s,o=O(),c=()=>{o("/mobile-recharge")};return e.jsxs(g,{className:"p-3 my-3 shadow-sm",children:[e.jsxs(g.Header,{as:"h5",className:"text-center",children:[e.jsx(We,{className:"me-2"})," Recharge"]}),e.jsxs(g.Body,{children:[e.jsxs(H,{children:[e.jsx(b,{md:6,children:e.jsx(f,{variant:"flush",children:e.jsxs(f.Item,{children:[e.jsx("strong",{children:"Number:"})," ",a.number]})})}),e.jsx(b,{md:6,children:e.jsx(f,{variant:"flush",children:e.jsxs(f.Item,{children:[e.jsx("strong",{children:"Amount:"})," ",t," ",r,l==="paid"?e.jsx(Ge,{className:"text-success ms-2"}):e.jsx(Ke,{className:"text-danger ms-2"})]})})})]}),e.jsx("hr",{}),e.jsx("div",{className:"text-center",children:e.jsx(y,{variant:"primary",onClick:c,children:"Recharge Again"})})]})]})},xs=({order:s})=>{const a=O(),[t,r]=d.useState(""),[l,o]=d.useState(!0);d.useEffect(()=>{var k;if((k=s==null?void 0:s.serviceResponse)!=null&&k.Booking_RefNo)r(s.serviceResponse.Booking_RefNo),o(!1);else{const A=setInterval(()=>{var w;(w=s==null?void 0:s.serviceResponse)!=null&&w.Booking_RefNo&&(r(s.serviceResponse.Booking_RefNo),o(!1),clearInterval(A))},500);return()=>clearInterval(A)}},[s]);const c=()=>{a("/flights")};if(!s)return e.jsx("div",{children:"No order data available"});const{serviceDetails:x,amount:h,currency:j,status:n}=s,{flightDetails:N}=x||{},{Origin:u,Destination:m,TravelDate:v}=N||{};return e.jsxs(g,{className:"p-3 my-3 shadow-sm",children:[e.jsxs(g.Header,{as:"h5",className:"text-center",children:[e.jsx(Ve,{className:"me-2"})," Flight Details"]}),e.jsx(g.Body,{children:e.jsxs(H,{children:[e.jsx(b,{md:6,children:e.jsxs(f,{variant:"flush",children:[e.jsxs(f.Item,{children:[e.jsx("strong",{children:"Origin:"})," ",(u==null?void 0:u.AIRPORTCODE)||"N/A"]}),e.jsxs(f.Item,{children:[e.jsx("strong",{children:"Destination:"})," ",(m==null?void 0:m.AIRPORTCODE)||"N/A"]}),e.jsxs(f.Item,{children:[e.jsx("strong",{children:"Travel Date:"})," ",v?new Date(v).toLocaleDateString():"N/A"]})]})}),e.jsx(b,{md:6,children:e.jsxs(f,{variant:"flush",children:[e.jsxs(f.Item,{children:[e.jsx("strong",{children:"Total Amount:"})," ",j?`${j} ${h}`:"N/A"]}),e.jsxs(f.Item,{children:[e.jsx("strong",{children:"Booking Reference No:"}),l?e.jsx(qe,{animation:"border",size:"sm",className:"ms-2"}):e.jsx("span",{className:"ms-2",children:t||"N/A"})]})]})})]})}),e.jsx(g.Footer,{className:"text-center",children:e.jsx(y,{variant:"primary",onClick:c,children:"Book Again"})})]})},js=({order:s})=>{if(!s)return e.jsx("div",{children:"No order data available"});const{serviceDetails:a,amount:t,currency:r,status:l}=s,{sourceName:o,destinationName:c,doj:x,seats:h}=a||{},{passengername:j,seatname:n}=h[0]||{},N=O(),u=()=>{N("/bus")};return e.jsxs(g,{className:"p-3 my-3 shadow-sm",children:[e.jsx(g.Header,{as:"h5",className:"text-center",children:"Bus Ticket Details"}),e.jsx(g.Body,{children:e.jsxs(H,{children:[e.jsx(b,{md:6,children:e.jsxs(f,{variant:"flush",children:[e.jsxs(f.Item,{children:[e.jsx("strong",{children:"From:"})," ",o||"N/A"]}),e.jsxs(f.Item,{children:[e.jsx("strong",{children:"To:"})," ",c||"N/A"]}),e.jsxs(f.Item,{children:[e.jsx("strong",{children:"Date of Journey:"})," ",x?new Date(x).toLocaleDateString():"N/A"]})]})}),e.jsx(b,{md:6,children:e.jsxs(f,{variant:"flush",children:[e.jsxs(f.Item,{children:[e.jsx("strong",{children:"Passenger Name:"})," ",j||"N/A"]}),e.jsxs(f.Item,{children:[e.jsx("strong",{children:"Seat Number:"})," ",n||"N/A"]}),e.jsxs(f.Item,{children:[e.jsx("strong",{children:"Total Amount:"})," ",r?`${r} ${t}`:"N/A"]})]})})]})}),e.jsx(g.Footer,{className:"text-center",children:e.jsx(y,{variant:"primary",onClick:u,children:"Book Again"})})]})},gs=({order:s})=>{const{serviceType:a,serviceDetails:t,amount:r,currency:l,status:o}=s,c=()=>{switch(a){case"bookbus":return e.jsx(e.Fragment,{children:e.jsx(js,{order:s})});case"recharge":return e.jsx(e.Fragment,{children:e.jsx(ms,{order:s})});case"bookflight":return e.jsx(e.Fragment,{children:e.jsx(xs,{order:s})});default:return e.jsx(e.Fragment,{})}};return e.jsx(e.Fragment,{children:c()})},fs=()=>{const[s,a]=d.useState([]),[t,r]=d.useState([]),[l,o]=d.useState(!0),c=d.useRef(null),x=20,h=async()=>{try{const n=await T.get("/api/dashboard/orders");a(n.data.orders),r(n.data.orders.slice(0,x)),n.data.orders.length<=x&&o(!1)}catch(n){console.error(n.response.data.message)}};d.useEffect(()=>{h()},[]);const j=()=>{t.length<s.length?r(n=>[...n,...s.slice(n.length,n.length+x)]):o(!1)};return d.useEffect(()=>{const n=()=>{const{scrollTop:u,clientHeight:m,scrollHeight:v}=c.current;u+m>=v&&l&&j()},N=c.current;return N&&N.addEventListener("scroll",n),()=>N&&N.removeEventListener("scroll",n)},[t,s,l]),e.jsxs("div",{className:"container  mt-4",children:[e.jsx("h4",{className:"m-2",children:"Orders"}),e.jsxs("div",{ref:c,style:{height:"calc(100vh - 80px)",overflowY:"auto"},className:"scroll-container",children:[t.length>0?t.map(n=>e.jsx(gs,{order:n},n.orderId)):e.jsx("p",{children:"No orders available"}),l&&e.jsx("h4",{children:"Loading more orders..."}),!l&&e.jsx("p",{children:"No more orders to show"})]})]})},Cs=()=>e.jsxs("div",{children:[e.jsx(us,{}),e.jsx(fs,{})]});export{Cs as default};
