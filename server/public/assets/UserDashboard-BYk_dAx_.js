import{r as i,u as R,j as e,c as v,d as He,a as ze,b as F,W as p,F as y,ap as _e,f as T,B,aq as We,Y as H,Z as M,ar as Ge,as as Ke,Q as Ye}from"./index-jTwt9OSH.js";import{u as qe,M as se,a as Je,S as Qe}from"./ClientRoutes-DtrhLnjh.js";import{a as U,u as Ve,B as ne,e as Ze,c as Xe,D as ae,F as re,G as Pe,o as es,H as ss,n as L}from"./NotFound-Bn2XVo_c.js";import{u as as,m as ts,B as ns,A as rs,M as ls,a as os,g as cs}from"./AbstractModalHeader-Bhpa3PiI.js";const le=i.forwardRef(({bsPrefix:s,active:a,disabled:t,eventKey:r,className:c,variant:l,action:d,as:m,...u},x)=>{s=R(s,"list-group-item");const[n,f]=as({key:ts(r,u.href),active:a,...u}),j=U(N=>{if(t){N.preventDefault(),N.stopPropagation();return}n.onClick(N)});t&&u.tabIndex===void 0&&(u.tabIndex=-1,u["aria-disabled"]=!0);const h=m||(d?u.href?"a":"button":"div");return e.jsx(h,{ref:x,...u,...n,onClick:j,className:v(c,s,f.isActive&&"active",t&&"disabled",l&&`${s}-${l}`,d&&`${s}-action`)})});le.displayName="ListGroupItem";const oe=i.forwardRef((s,a)=>{const{className:t,bsPrefix:r,variant:c,horizontal:l,numbered:d,as:m="div",...u}=Ve(s,{activeKey:"onSelect"}),x=R(r,"list-group");let n;return l&&(n=l===!0?"horizontal":`horizontal-${l}`),e.jsx(ns,{ref:a,...u,as:m,className:v(t,x,c&&`${x}-${c}`,n&&`${x}-${n}`,d&&`${x}-numbered`)})});oe.displayName="ListGroup";const g=Object.assign(oe,{Item:le});var I;function te(s){if((!I&&I!==0||s)&&ne){var a=document.createElement("div");a.style.position="absolute",a.style.top="-9999px",a.style.width="50px",a.style.height="50px",a.style.overflow="scroll",document.body.appendChild(a),I=a.offsetWidth-a.clientWidth,document.body.removeChild(a)}return I}const ce=i.forwardRef(({className:s,bsPrefix:a,as:t="div",...r},c)=>(a=R(a,"modal-body"),e.jsx(t,{ref:c,className:v(s,a),...r})));ce.displayName="ModalBody";const z=i.forwardRef(({bsPrefix:s,className:a,contentClassName:t,centered:r,size:c,fullscreen:l,children:d,scrollable:m,...u},x)=>{s=R(s,"modal");const n=`${s}-dialog`,f=typeof l=="string"?`${s}-fullscreen-${l}`:`${s}-fullscreen`;return e.jsx("div",{...u,ref:x,className:v(n,a,c&&`${s}-${c}`,r&&`${n}-centered`,m&&`${n}-scrollable`,l&&f),children:e.jsx("div",{className:v(`${s}-content`,t),children:d})})});z.displayName="ModalDialog";const ie=i.forwardRef(({className:s,bsPrefix:a,as:t="div",...r},c)=>(a=R(a,"modal-footer"),e.jsx(t,{ref:c,className:v(s,a),...r})));ie.displayName="ModalFooter";const de=i.forwardRef(({bsPrefix:s,className:a,closeLabel:t="Close",closeButton:r=!1,...c},l)=>(s=R(s,"modal-header"),e.jsx(rs,{ref:l,...c,className:v(a,s),closeLabel:t,closeButton:r})));de.displayName="ModalHeader";const is=He("h4"),ue=i.forwardRef(({className:s,bsPrefix:a,as:t=is,...r},c)=>(a=R(a,"modal-title"),e.jsx(t,{ref:c,className:v(s,a),...r})));ue.displayName="ModalTitle";function ds(s){return e.jsx(re,{...s,timeout:null})}function us(s){return e.jsx(re,{...s,timeout:null})}const he=i.forwardRef(({bsPrefix:s,className:a,style:t,dialogClassName:r,contentClassName:c,children:l,dialogAs:d=z,"data-bs-theme":m,"aria-labelledby":u,"aria-describedby":x,"aria-label":n,show:f=!1,animation:j=!0,backdrop:h=!0,keyboard:N=!0,onEscapeKeyDown:b,onShow:S,onHide:C,container:me,autoFocus:xe=!0,enforceFocus:je=!0,restoreFocus:ge=!0,restoreFocusOptions:fe,onEntered:Ne,onExit:_,onExiting:pe,onEnter:W,onEntering:G,onExited:K,backdropClassName:Y,manager:q,...ve},ye)=>{const[Re,Ce]=i.useState({}),[we,J]=i.useState(!1),E=i.useRef(!1),$=i.useRef(!1),k=i.useRef(null),[A,Me]=qe(),be=Ze(ye,Me),Q=U(C),ke=ze();s=R(s,"modal");const Ae=i.useMemo(()=>({onHide:Q}),[Q]);function V(){return q||cs({isRTL:ke})}function Z(o){if(!ne)return;const w=V().getScrollbarWidth()>0,ee=o.scrollHeight>es(o).documentElement.clientHeight;Ce({paddingRight:w&&!ee?te():void 0,paddingLeft:!w&&ee?te():void 0})}const O=U(()=>{A&&Z(A.dialog)});Xe(()=>{ae(window,"resize",O),k.current==null||k.current()});const De=()=>{E.current=!0},Se=o=>{E.current&&A&&o.target===A.dialog&&($.current=!0),E.current=!1},X=()=>{J(!0),k.current=ss(A.dialog,()=>{J(!1)})},Be=o=>{o.target===o.currentTarget&&X()},Ie=o=>{if(h==="static"){Be(o);return}if($.current||o.target!==o.currentTarget){$.current=!1;return}C==null||C()},Te=o=>{N?b==null||b(o):(o.preventDefault(),h==="static"&&X())},Fe=(o,w)=>{o&&Z(o),W==null||W(o,w)},Ee=o=>{k.current==null||k.current(),_==null||_(o)},$e=(o,w)=>{G==null||G(o,w),Pe(window,"resize",O)},Oe=o=>{o&&(o.style.display=""),K==null||K(o),ae(window,"resize",O)},Le=i.useCallback(o=>e.jsx("div",{...o,className:v(`${s}-backdrop`,Y,!j&&"show")}),[j,Y,s]),P={...t,...Re};P.display="block";const Ue=o=>e.jsx("div",{role:"dialog",...o,style:P,className:v(a,s,we&&`${s}-static`,!j&&"show"),onClick:h?Ie:void 0,onMouseUp:Se,"data-bs-theme":m,"aria-label":n,"aria-labelledby":u,"aria-describedby":x,children:e.jsx(d,{...ve,onMouseDown:De,className:r,contentClassName:c,children:l})});return e.jsx(ls.Provider,{value:Ae,children:e.jsx(os,{show:f,ref:be,backdrop:h,container:me,keyboard:!0,autoFocus:xe,enforceFocus:je,restoreFocus:ge,restoreFocusOptions:fe,onEscapeKeyDown:Te,onShow:S,onHide:C,onEnter:Fe,onEntering:$e,onEntered:Ne,onExit:Ee,onExiting:pe,onExited:Oe,manager:V(),transition:j?ds:void 0,backdropTransition:j?us:void 0,renderBackdrop:Le,renderDialog:Ue})})});he.displayName="Modal";const D=Object.assign(he,{Body:ce,Header:de,Title:ue,Footer:ie,Dialog:z,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),hs=()=>{const[s,a]=i.useState(null),[t,r]=i.useState(!1),[c,l]=i.useState(!1),[d,m]=i.useState({}),u=F();i.useEffect(()=>{(async()=>{try{const N=await T.get("/api/user-by-id");a(N.data)}catch(N){B.error(N.response.data.message),N.response.status===401&&u(N.response.data.redirect)}})()},[]);const x=()=>{r(!0),m({name:s.name,email:s.email,mobileNumber:s.mobileNumber})},n=async()=>{try{await T.delete("/api/delete-user"),B.info("User deleted successfully"),localStorage.clear(),u("/")}catch(h){console.error(h)}l(!1)},f=async()=>{try{await T.put("/api/update-user",d),B.success("User updated successfully"),a({...s,...d}),r(!1)}catch(h){console.error(h),B.error("User updated failed")}},j=h=>{m({...d,[h.target.name]:h.target.value})};return e.jsxs("div",{className:"container mt-5 ",children:[s?e.jsx(p,{style:{border:"none"},children:e.jsxs(p.Body,{className:"d-flex flex-column flex-lg-row justify-content-between align-items-center",children:[t?e.jsx("div",{className:"container align-item-center",children:e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(p.Text,{children:e.jsx(L.Control,{type:"text",name:"name",value:d.name,onChange:j,placeholder:"Name"})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(p.Text,{children:t?e.jsx(L.Control,{type:"email",name:"email",value:d.email,onChange:j,placeholder:"Email"}):e.jsx(e.Fragment,{})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(p.Text,{children:t?e.jsx(L.Control,{type:"text",name:"mobileNumber",value:d.mobileNumber,onChange:j,placeholder:"Mobile Number"}):e.jsx(e.Fragment,{})})})]})}):e.jsx("div",{children:e.jsx("h5",{children:e.jsxs("strong",{children:["Welcome ",s.name]})})}),e.jsxs("div",{className:"p-2",children:[!t&&e.jsx(y,{style:{width:"2.6rem",height:"2.4rem"},variant:"primary",onClick:x,className:"mx-2",children:e.jsx(_e,{})}),e.jsx(y,{variant:"danger",style:{width:"2.6rem",height:"2.4rem"},onClick:()=>l(!0),className:"mx-2",children:e.jsx(se,{})})]})]})}):e.jsx("p",{children:"Loading..."}),e.jsxs(D,{show:c,onHide:()=>l(!1),children:[e.jsx(D.Header,{closeButton:!0,children:e.jsx(D.Title,{children:"Confirm Delete"})}),e.jsx(D.Body,{children:"Are you sure you want to delete this user?"}),e.jsxs(D.Footer,{children:[e.jsx(y,{variant:"secondary",onClick:()=>l(!1),children:e.jsx(Je,{})}),e.jsx(y,{variant:"danger",onClick:n,children:e.jsx(se,{})})]})]}),t&&e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(y,{variant:"success",onClick:f,children:"Save"})})]})},ms=({order:s})=>{const{serviceDetails:a,amount:t,currency:r,status:c}=s,l=F(),d=()=>{l("/mobile-recharge")};return e.jsxs(p,{className:"p-3 my-3 shadow-sm",children:[e.jsxs(p.Header,{as:"h5",className:"text-center",children:[e.jsx(We,{className:"me-2"})," Recharge"]}),e.jsxs(p.Body,{children:[e.jsxs(H,{children:[e.jsx(M,{md:6,children:e.jsx(g,{variant:"flush",children:e.jsxs(g.Item,{children:[e.jsx("strong",{children:"Number:"})," ",a.number]})})}),e.jsx(M,{md:6,children:e.jsx(g,{variant:"flush",children:e.jsxs(g.Item,{children:[e.jsx("strong",{children:"Amount:"})," ",t," ",r,c==="paid"?e.jsx(Ge,{className:"text-success ms-2"}):e.jsx(Ke,{className:"text-danger ms-2"})]})})})]}),e.jsx("hr",{}),e.jsx("div",{className:"text-center",children:e.jsx(y,{variant:"primary",onClick:d,children:"Recharge Again"})})]})]})},xs=({order:s})=>{const a=F(),[t,r]=i.useState(""),[c,l]=i.useState(!0);i.useEffect(()=>{var b;if((b=s==null?void 0:s.serviceResponse)!=null&&b.Booking_RefNo)r(s.serviceResponse.Booking_RefNo),l(!1);else{const S=setInterval(()=>{var C;(C=s==null?void 0:s.serviceResponse)!=null&&C.Booking_RefNo&&(r(s.serviceResponse.Booking_RefNo),l(!1),clearInterval(S))},500);return()=>clearInterval(S)}},[s]);const d=()=>{a("/flights")};if(!s)return e.jsx("div",{children:"No order data available"});const{serviceDetails:m,amount:u,currency:x,status:n}=s,{flightDetails:f}=m||{},{Origin:j,Destination:h,TravelDate:N}=f||{};return e.jsxs(p,{className:"p-3 my-3 shadow-sm",children:[e.jsxs(p.Header,{as:"h5",className:"text-center",children:[e.jsx(Ye,{className:"me-2"})," Flight Details"]}),e.jsx(p.Body,{children:e.jsxs(H,{children:[e.jsx(M,{md:6,children:e.jsxs(g,{variant:"flush",children:[e.jsxs(g.Item,{children:[e.jsx("strong",{children:"Origin:"})," ",(j==null?void 0:j.AIRPORTCODE)||"N/A"]}),e.jsxs(g.Item,{children:[e.jsx("strong",{children:"Destination:"})," ",(h==null?void 0:h.AIRPORTCODE)||"N/A"]}),e.jsxs(g.Item,{children:[e.jsx("strong",{children:"Travel Date:"})," ",N?new Date(N).toLocaleDateString():"N/A"]})]})}),e.jsx(M,{md:6,children:e.jsxs(g,{variant:"flush",children:[e.jsxs(g.Item,{children:[e.jsx("strong",{children:"Total Amount:"})," ",x?`${x} ${u}`:"N/A"]}),e.jsxs(g.Item,{children:[e.jsx("strong",{children:"Booking Reference No:"}),c?e.jsx(Qe,{animation:"border",size:"sm",className:"ms-2"}):e.jsx("span",{className:"ms-2",children:t||"N/A"})]})]})})]})}),e.jsx(p.Footer,{className:"text-center",children:e.jsx(y,{variant:"primary",onClick:d,children:"Book Again"})})]})},js=({order:s})=>{if(!s)return e.jsx("div",{children:"No order data available"});const{serviceDetails:a,amount:t,currency:r,status:c}=s,{sourceName:l,destinationName:d,doj:m,seats:u}=a||{},{passengername:x,seatname:n}=u[0]||{},f=F(),j=()=>{f("/bus")};return e.jsxs(p,{className:"p-3 my-3 shadow-sm",children:[e.jsx(p.Header,{as:"h5",className:"text-center",children:"Bus Ticket Details"}),e.jsx(p.Body,{children:e.jsxs(H,{children:[e.jsx(M,{md:6,children:e.jsxs(g,{variant:"flush",children:[e.jsxs(g.Item,{children:[e.jsx("strong",{children:"From:"})," ",l||"N/A"]}),e.jsxs(g.Item,{children:[e.jsx("strong",{children:"To:"})," ",d||"N/A"]}),e.jsxs(g.Item,{children:[e.jsx("strong",{children:"Date of Journey:"})," ",m?new Date(m).toLocaleDateString():"N/A"]})]})}),e.jsx(M,{md:6,children:e.jsxs(g,{variant:"flush",children:[e.jsxs(g.Item,{children:[e.jsx("strong",{children:"Passenger Name:"})," ",x||"N/A"]}),e.jsxs(g.Item,{children:[e.jsx("strong",{children:"Seat Number:"})," ",n||"N/A"]}),e.jsxs(g.Item,{children:[e.jsx("strong",{children:"Total Amount:"})," ",r?`${r} ${t}`:"N/A"]})]})})]})}),e.jsx(p.Footer,{className:"text-center",children:e.jsx(y,{variant:"primary",onClick:j,children:"Book Again"})})]})},gs=({order:s})=>{const{serviceType:a,serviceDetails:t,amount:r,currency:c,status:l}=s,d=()=>{switch(a){case"bookbus":return e.jsx(e.Fragment,{children:e.jsx(js,{order:s})});case"recharge":return e.jsx(e.Fragment,{children:e.jsx(ms,{order:s})});case"bookflight":return e.jsx(e.Fragment,{children:e.jsx(xs,{order:s})});default:return e.jsx(e.Fragment,{})}};return e.jsx(e.Fragment,{children:d()})},fs=()=>{const[s,a]=i.useState([]),[t,r]=i.useState([]),[c,l]=i.useState(!0),d=i.useRef(null),m=20,u=async()=>{try{const n=await T.get("/api/dashboard/orders");a(n.data.orders),r(n.data.orders.slice(0,m)),n.data.orders.length<=m&&l(!1)}catch(n){console.error(n.response.data.message)}};i.useEffect(()=>{u()},[]);const x=()=>{t.length<s.length?r(n=>[...n,...s.slice(n.length,n.length+m)]):l(!1)};return i.useEffect(()=>{const n=()=>{const{scrollTop:j,clientHeight:h,scrollHeight:N}=d.current;j+h>=N&&c&&x()},f=d.current;return f&&f.addEventListener("scroll",n),()=>f&&f.removeEventListener("scroll",n)},[t,s,c]),e.jsxs("div",{className:"container  mt-4",children:[e.jsx("h4",{className:"m-2",children:"Orders"}),e.jsxs("div",{ref:d,style:{height:"calc(100vh - 80px)",overflowY:"auto"},className:"scroll-container",children:[t.length>0?t.map(n=>e.jsx(gs,{order:n},n.orderId)):e.jsx("p",{children:"No orders available"}),c&&e.jsx("h4",{children:"Loading more orders..."})]})]})},Rs=()=>e.jsxs("div",{children:[e.jsx(hs,{}),e.jsx(fs,{})]});export{Rs as default};
